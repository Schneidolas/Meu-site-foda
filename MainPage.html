<!DOCTYPE html>
<html>
<head>
    <title>YouTubo - Broadcast Yourself!</title>
    <link rel="stylesheet" href="mainPage.css">
    <meta charset="UTF-8">
</head>
<body>

<div class="main-container">
    <center>
        <img src="https://i.imgur.com/uNPA4yV.gif" alt="Bem-vindo ao YouTubo!">
        <h1><font face="Comic Sans MS" color="yellow">Bem-Vindo ao YouTubo!</font></h1>
        <form id="search-form">
            <input type="text" id="search-input" placeholder="Procure por vídeos...">
            <button type="submit">Buscar</button>
        </form>
        <img src="https://gifcities.org/assets/images/under-construction-34.gif" height="50">
    </center>
    <hr>
    <h2><img src="https://www.animatedimages.org/data/media/139/animated-arrow-image-0205.gif" width="30"> Vídeos em Destaque <img src="https://www.animatedimages.org/data/media/139/animated-arrow-image-0205.gif" width="30"></h2>
    <div id="video-grid"></div>
</div>
<hr>

<script src="database.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
    const videoGrid = document.getElementById('video-grid');
    const searchForm = document.getElementById('search-form');
    const searchInput = document.getElementById('search-input');

    const renderVideos = (videosToRender) => {
        videoGrid.innerHTML = '';
        if (Object.keys(videosToRender).length === 0) {
            videoGrid.innerHTML = '<p><font color="white">Nenhum vídeo encontrado.</font></p>';
            return;
        }

        for (const videoId in videosToRender) {
            const video = videosToRender[videoId];
            const videoElement = document.createElement('div');
            videoElement.className = 'video-item';
            // Link agora usa ?v=VIDEO_ID e aponta para o novo player
            videoElement.innerHTML = `
                <a href="videoPlayer.html?v=${video.id}">
                    <img src="${video.thumbnail}" class="thumbnail" alt="${video.title}">
                    <br>
                    <b>${video.title}</b>
                </a>
                <p>de: <a href="userPage.html?id=${video.channelId}">${video.channelId}</a></p>
            `;
            videoGrid.appendChild(videoElement);
        }
    };
    
    const handleSearch = (event) => {
        event.preventDefault();
        const searchTerm = searchInput.value.toLowerCase().trim();
        if (!searchTerm) {
            renderVideos(youtubo_db.videos); // Mostra todos se a busca for vazia
            return;
        }

        const filteredVideos = {};
        for (const videoId in youtubo_db.videos) {
            const video = youtubo_db.videos[videoId];
            if (video.title.toLowerCase().includes(searchTerm) || video.description.toLowerCase().includes(searchTerm)) {
                filteredVideos[videoId] = video;
            }
        }
        renderVideos(filteredVideos);
    };

    searchForm.addEventListener('submit', handleSearch);
    renderVideos(youtubo_db.videos); // Renderiza todos os vídeos inicialmente
});
</script>
</body>
</html>